name: Ping Render Health (Primary + Backup)

on:
  schedule:
    - cron: "*/5 * * * *"   # –∫–æ–∂–Ω—ñ 5 —Ö–≤
  workflow_dispatch:        # –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–ø—É—Å–∫—É –≤—Ä—É—á–Ω—É

jobs:
  ping-render:
    runs-on: ubuntu-latest
    steps:
      - name: Curl /health and /
        run: |
          set -e
          BASE_URL="https://telegram-bot-auto-georgia.onrender.com"

          echo "üîπ Checking primary endpoint: $BASE_URL/health"
          http_code_health=$(curl -s -o /dev/null -w "%{http_code}" "$BASE_URL/health")
          echo "Health check: HTTP $http_code_health"

          echo "üîπ Checking backup endpoint: $BASE_URL/"
          http_code_root=$(curl -s -o /dev/null -w "%{http_code}" "$BASE_URL/")
          echo "Root check: HTTP $http_code_root"

          if [ "$http_code_health" -eq 200 ] || [ "$http_code_root" -eq 200 ]; then
            echo "‚úÖ At least one endpoint is alive."
            exit 0
          else
            echo "‚ùå Both checks failed."
            exit 1
          fi
